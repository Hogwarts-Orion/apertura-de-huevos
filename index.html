<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tienda de Criaturas MÃ¡gicas - Hogwarts OriÃ³n</title>
    <style>
        body { 
            margin: 0; 
            background: #0a1a0a url('https://images.unsplash.com/photo-1519751138087-5bf79df62d5b?auto=format&fit=crop&w=1920&q=80') no-repeat center fixed;
            background-size: cover; font-family: 'Georgia', serif; color: #fff;
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: -1; }
        .main-box { width: 95%; max-width: 500px; background: rgba(20, 40, 20, 0.9); border: 2px solid #8eeb9b; border-radius: 15px; padding: 30px; text-align: center; box-shadow: 0 0 20px rgba(142, 235, 155, 0.4); }
        input { width: 100%; padding: 12px; margin: 15px 0; border-radius: 8px; border: 1px solid #8eeb9b; background: #000; color: #8eeb9b; font-size: 16px; box-sizing: border-box; text-align: center; }
        .btn-incubar { background: #2e7d32; color: white; border: none; padding: 15px 50px; border-radius: 10px; font-weight: bold; font-size: 22px; cursor: pointer; transition: 0.3s; width: 100%; }
        .btn-incubar:hover { background: #4caf50; transform: scale(1.02); box-shadow: 0 0 15px #8eeb9b; }
        .historial-box { width: 95%; max-width: 600px; background: rgba(0,0,0,0.9); border: 2px solid #8eeb9b; border-radius: 12px; padding: 20px; margin-top: 30px; }
        .entrada-criatura { position: relative; background: rgba(255,255,255,0.05); border-left: 4px solid #8eeb9b; padding: 15px; margin-bottom: 15px; border-radius: 8px; text-align: left; }
        .btn-copiar { position: absolute; top: 10px; right: 10px; background: #8eeb9b; color: #000; border: none; padding: 5px 10px; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <h1 style="color: #8eeb9b; text-shadow: 2px 2px #000;">ğŸ¾ Tienda de Criaturas MÃ¡gicas ğŸ¾</h1>
    
    <div class="main-box">
        <h3 style="margin-top:0; color: #8eeb9b;">ğŸ¥š Incubadora de Huevos</h3>
        <input type="text" id="nombre-mago" placeholder="Nombre del Mago/Bruja...">
        <button class="btn-incubar" onclick="abrirHuevos()">Incubar 1 Huevo âœ¨</button>
    </div>

    <div id="historial-seccion" class="historial-box">
        <h2 style="color:#8eeb9b; text-align:center; margin-top:0;">ğŸ“œ Registro de Criaturas</h2>
        <div id="log-content">Cargando nidos mÃ¡gicos...</div>
    </div>

    <script>
        const DB_URL = "https://apertura-de-huevos-default-rtdb.firebaseio.com/criaturas.json";

        // Listas para el Panda y Conejo
        const PREMIOS_PANDA = ["+5.000 G ğŸª™", "+7.000 P ğŸ’–", "+10.000 P ğŸ’–", "+3.000 G ğŸª™", "1 PociÃ³n FÃ©lix Felicis ğŸ€", "1 Gragea de todos los sabores ğŸ«˜"];
        const PRODUCTOS_CONEJO = ["PociÃ³n Amortentia ğŸ§ª", "Pastillas Vomitivas ğŸ’Š", "Cerveza de Mantequilla ğŸº", "Pluma de Vuela-Pluma ğŸª¶", "Recordadora ğŸ±"];

        const MASCOTAS = [
            {n: "JAGUAR ğŸ†", h: "Te permite robar una habilidad de otra mascota por un dÃ­a.", u: "1 uso al dÃ­a.", a: "Tienda"},
            {n: "OSO PANDA ğŸ¼", h: "ElecciÃ³n entre 2 cosas aleatorias.", u: "1 uso al dÃ­a.", a: "Tienda", tipo: "panda"},
            {n: "CONEJO ğŸ°", h: "Ganas un producto al azar todos los dÃ­as.", u: "1 uso al dÃ­a.", a: "Tienda", tipo: "conejo"},
            {n: "ESCARBATO ğŸ¦”", h: "Busca y encuentra 2.000 galeones para el dueÃ±o.", u: "1 uso al dÃ­a.", a: "Tienda", regalo: "2.000 G ğŸª™"},
            {n: "MURCIÃ‰LAGO ğŸ¦‡", h: "Roba 2.000 galeones a alguien al azar.", u: "1 uso al dÃ­a.", a: "Tienda", regalo: "2.000 G ğŸª™ (Robados)"},
            {n: "HOCICORTO SUECO ğŸ—", h: "Te da el doble de galeones en Quidditch.", u: "1 uso por partido.", a: "Estadio"},
            // ... (el resto de las mascotas se mantienen igual)
            {n: "COLACUERNO HÃšNGARO ğŸ²", h: "50% mÃ¡s de puntos en Quidditch por participaciÃ³n.", u: "1 uso por partido.", a: "Estadio"}
        ];

        function abrirHuevos() {
            const nombre = document.getElementById('nombre-mago').value || "Mago/Bruja";
            const m = MASCOTAS[Math.floor(Math.random() * MASCOTAS.length)];
            const fecha = new Date().toLocaleDateString();
            
            // Generar regalo especial si aplica
            let extraInfo = "";
            if(m.tipo === "panda") {
                const p1 = PREMIOS_PANDA[Math.floor(Math.random() * PREMIOS_PANDA.length)];
                const p2 = PREMIOS_PANDA[Math.floor(Math.random() * PREMIOS_PANDA.length)];
                extraInfo = `\nğŸ OPCIONES DEL PANDA:\n1. ${p1}\n2. ${p2}`;
            } else if(m.tipo === "conejo") {
                const prod = PRODUCTOS_CONEJO[Math.floor(PRODUCTOS_CONEJO.length)];
                extraInfo = `\nğŸ REGALO DEL DÃA: ${prod}`;
            } else if(m.regalo) {
                extraInfo = `\nğŸ’° RECOMPENSA INICIAL: ${m.regalo}`;
            }

            let textoCopiable = `â‹† â€”â€”â€”â€”â€”â€”âœ§â—¦ğŸ¥šâ—¦âœ§â€”â€”â€”â€”â€”â€” â‹†\n\n      âœ¨ á´á´€êœ±á´„á´á´›á´€êœ± âœ¨\n\n   ğŸ‰Â¡Felicidades @${nombre}! te toco un ğŸ‰\n\nâ¢ ${m.n}\n${m.h}${extraInfo}\n\nâ†’ Habilidad desbloqueada el ${fecha}\nã€‹${m.u.toUpperCase()}\n> Avisar de su uso en ${m.a}\n\nğŸ† RECOMPENSAS DE CRECIMIENTO:\nâ˜† Nivel 1 (5 dÃ­as): +10.000p / +4.000G\nâ˜† Nivel 2 (10 dÃ­as): +18.000p / +7.000G\nâ˜† Nivel 5 (25 dÃ­as): Â¡INMORTALIDAD!\n\nâ‹† â€”â€”â€”â€”â€”â€”âœ§â—¦ğŸ¥šâ—¦âœ§â€”â€”â€”â€”â€”â€” â‹†`;
            
            let htmlEntrada = `<div class="entrada-criatura">
                <button class="btn-copiar" onclick="copiar(this)">Copiar ğŸ“‹</button>
                <div style="font-size:11px; color:#aaa;">${new Date().toLocaleString()}</div>
                <div style="color:#8eeb9b; font-weight:bold;">ğŸ§™â€â™‚ï¸ ${nombre}: Â¡Ha nacido un ${m.n}!</div>
                <div style="font-size:13px; color:#ddd;">${m.h}</div>
                <textarea style="display:none">${textoCopiable}</textarea>
            </div>`;

            fetch(DB_URL, { method: 'POST', body: JSON.stringify(htmlEntrada) }).then(() => {
                cargarHistorial();
                document.getElementById('historial-seccion').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('nombre-mago').value = "";
            });
        }

        function copiar(btn) {
            const txt = btn.parentElement.querySelector('textarea').value;
            navigator.clipboard.writeText(txt).then(() => {
                btn.innerText = "Â¡Copiado! âœ…";
                setTimeout(() => btn.innerText = "Copiar ğŸ“‹", 2000);
            });
        }

        function cargarHistorial() {
            fetch(DB_URL).then(res => res.json()).then(data => {
                const log = document.getElementById('log-content');
                if(!data) { log.innerHTML = "No hay criaturas."; return; }
                let html = "";
                Object.values(data).reverse().forEach(e => html += e);
                log.innerHTML = html;
            });
        }

        window.onload = cargarHistorial;
        setInterval(cargarHistorial, 5000);
    </script>
</body>
</html>
