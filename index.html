<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tienda de Criaturas M√°gicas - Hogwarts Ori√≥n</title>
    <style>
        body { 
            margin: 0; 
            background: #0a1a0a url('https://images.unsplash.com/photo-1519751138087-5bf79df62d5b?auto=format&fit=crop&w=1920&q=80') no-repeat center fixed;
            background-size: cover; font-family: 'Georgia', serif; color: #fff;
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: -1; }
        .main-box, .action-box { 
            width: 95%; max-width: 500px; background: rgba(20, 40, 20, 0.9); 
            border: 2px solid #8eeb9b; border-radius: 15px; padding: 25px; 
            text-align: center; box-shadow: 0 0 20px rgba(142, 235, 155, 0.4); margin-bottom: 20px;
        }
        input, select { 
            width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; 
            border: 1px solid #8eeb9b; background: #000; color: #8eeb9b; font-size: 15px; box-sizing: border-box; text-align: center;
        }
        .btn-magico { 
            background: #2e7d32; color: white; border: none; padding: 15px; 
            border-radius: 10px; font-weight: bold; font-size: 18px; cursor: pointer; transition: 0.3s; width: 100%; margin-top: 10px;
        }
        .btn-magico:hover { background: #4caf50; transform: scale(1.02); }
        .historial-box { width: 95%; max-width: 600px; background: rgba(0,0,0,0.9); border: 2px solid #8eeb9b; border-radius: 12px; padding: 20px; }
        .entrada-criatura { 
            position: relative; background: rgba(255,255,255,0.05); border-left: 4px solid #8eeb9b; 
            padding: 15px; margin-bottom: 15px; border-radius: 8px; text-align: left;
        }
        .btn-copiar {
            position: absolute; top: 10px; right: 10px; background: #8eeb9b; color: #000;
            border: none; padding: 5px 10px; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <h1>üêæ Tienda de Criaturas M√°gicas üêæ</h1>
    
    <div class="main-box">
        <h3 style="margin:0; color: #8eeb9b;">ü•ö Incubadora de Huevos</h3>
        <input type="text" id="nombre-mago" placeholder="Tu nombre de Mago/Bruja...">
        <button class="btn-magico" onclick="abrirHuevos()">Incubar 1 Huevo ‚ú®</button>
    </div>

    <div class="action-box">
        <h3 style="margin:0; color: #f9e29c;">‚ú® Habilidades Diarias</h3>
        <input type="text" id="nombre-mascota-accion" placeholder="Nombre de la mascota (ej: Rigoberto)">
        <input type="text" id="nombre-due√±o-accion" placeholder="Nombre del due√±o (ej: @Jere)">
        
        <select id="casa-due√±o">
            <option value="üíö">Slytherin (Verde)</option>
            <option value="‚ù§Ô∏è">Gryffindor (Rojo)</option>
            <option value="üíõ">Hufflepuff (Amarillo)</option>
            <option value="üíô">Ravenclaw (Azul)</option>
        </select>

        <select id="tipo-mascota">
            <option value="panda">Oso Panda üêº (Elegir entre 2 opciones)</option>
            <option value="conejo">Conejo üê∞ (Producto al Azar)</option>
            <option value="escarbato">Escarbato ü¶î (2.000 Galeones)</option>
            <option value="murcielago">Murci√©lago ü¶á (Robar 2.000 Galeones)</option>
        </select>

        <button class="btn-magico" style="background: #a48a26;" onclick="usarHabilidad()">Usar Habilidad üêæ</button>
    </div>

    <div id="historial-seccion" class="historial-box">
        <h2 style="color:#8eeb9b; text-align:center; margin-top:0;">üìú Registro de Actividad</h2>
        <div id="log-content">Cargando nidos m√°gicos...</div>
    </div>

    <script>
        const DB_URL = "https://apertura-de-huevos-default-rtdb.firebaseio.com/criaturas.json";

        const OBJETOS_TIENDA = [
            "Saeta de fuego üî•üßπ", "Nimbus 2000 ü™Ωüßπ", "Anillo de Morf√≠n Gaunt üíç", "Varita de sa√∫co ü™ÑüíÄ",
            "El desiluminador üí°", "Pergamino m√°gico üìú", "El traslador üîÆ", "Carta vociferadora üíå",
            "Giratiempo ‚è±", "F√©lix felicis üçÄüß™", "Pluma de Hermione ü™∂", "Amortentia üíòüß™",
            "Pastillas vomitivas üíä", "Ranita Amarilla üíõüç´", "Ranita verde üíöüç´", "Ranita roja ‚ù§Ô∏èüç´",
            "Ranita negra üñ§üç´", "Ranita rosa ü©∑üç´", "Ranita lila üíúüç´", "Ranita naranja üß°üç´",
            "Ranita celeste ü©µüç´", "Espejo de Oesed ü™û", "La recordadora de Neville üé±", "Gragea de todos los sabores ü´ò"
        ];

        const PREMIOS_GENERALES = [
            "+7.000 P üíñ", "+5.000 G ü™ô", "+10.000 P üíñ", "+8.000 P üíñ", "+4.000 G ü™ô", "+15.000 P üíñ", "+6.000 G ü™ô"
        ];

        function abrirHuevos() {
            const MASCOTAS = [
                {n: "JAGUAR üêÜ", h: "Te permite robar una habilidad de otra mascota por un d√≠a.", u: "1 uso al d√≠a.", a: "Tienda"},
                {n: "OSO PANDA üêº", h: "Te da la posibilidad de elegir entre 2 cosas aleatorias.", u: "1 uso al d√≠a.", a: "Tienda"},
                {n: "CONEJO üê∞", h: "Ganas un producto al azar todos los d√≠as.", u: "1 uso al d√≠a.", a: "Tienda"},
                {n: "ESCARBATO ü¶î", h: "Busca y encuentra 2.000 galeones para el due√±o.", u: "1 uso al d√≠a.", a: "Tienda"},
                {n: "MURCI√âLAGO ü¶á", h: "Roba 2.000 galeones a alguien al azar.", u: "1 uso al d√≠a.", a: "Tienda"},
                {n: "HOCICORTO SUECO üêó", h: "Te da el doble de galeones en Quidditch.", u: "1 uso por partido.", a: "Estadio"},
                {n: "COLACUERNO H√öNGARO üê≤", h: "50% m√°s de puntos en Quidditch por participaci√≥n.", u: "1 uso por partido.", a: "Estadio"}
                // Se pueden agregar todas las dem√°s aqu√≠
            ];
            const nombre = document.getElementById('nombre-mago').value || "Mago/Bruja";
            const m = MASCOTAS[Math.floor(Math.random() * MASCOTAS.length)];
            const tiempo = new Date().toLocaleDateString();
            let textoCopiable = `‚ãÜ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚úß‚ó¶ü•ö‚ó¶‚úß‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî ‚ãÜ\n\n      ‚ú® ·¥ç·¥ÄÍú±·¥Ñ·¥è·¥õ·¥ÄÍú± ‚ú®\n\n   üéâ¬°Felicidades @${nombre}! te toco un üéâ\n\n‚û¢${m.n}\n${m.h}\n\n‚Üí Habilidad desbloqueada en el d√≠a 10\n\n„Äã${m.u.toUpperCase()}\n\n> Avisar de su uso en ${m.a}\n\n‚ãÜ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚úß‚ó¶ü•ö‚ó¶‚úß‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî ‚ãÜ`;
            enviarHistorial(nombre, `Ha incubado un huevo: <b>${m.n}</b>`, textoCopiable);
            document.getElementById('nombre-mago').value = "";
        }

        function usarHabilidad() {
            const mascotaNom = document.getElementById('nombre-mascota-accion').value || "Tu mascota";
            const due√±oNom = document.getElementById('nombre-due√±o-accion').value || "@Mago";
            const casaEmoji = document.getElementById('casa-due√±o').value;
            const tipo = document.getElementById('tipo-mascota').value;
            
            let resultado = "";
            let logTexto = "";

            const listaCompleta = [...OBJETOS_TIENDA, ...PREMIOS_GENERALES];

            if(tipo === "panda") {
                // Obtener 2 premios distintos
                let p1 = listaCompleta[Math.floor(Math.random() * listaCompleta.length)];
                let p2 = listaCompleta[Math.floor(Math.random() * listaCompleta.length)];
                while(p1 === p2) { p2 = listaCompleta[Math.floor(Math.random() * listaCompleta.length)]; }
                
                resultado = `√óüêº ${mascotaNom} te da elegir entre: [${casaEmoji}]\n1. ${p1}\n2. ${p2}\n${due√±oNom} ${casaEmoji}√ó`;
                logTexto = `El Panda <b>${mascotaNom}</b> ofreci√≥ 2 opciones a ${due√±oNom}`;
            } else if(tipo === "conejo") {
                const pr = OBJETOS_TIENDA[Math.floor(Math.random() * OBJETOS_TIENDA.length)];
                resultado = `√óüê∞ ${mascotaNom} te trae suerte: [${casaEmoji}] ¬°Has ganado ${pr}! ${due√±oNom} ${casaEmoji}√ó`;
                logTexto = `El Conejo <b>${mascotaNom}</b> encontr√≥ un objeto para ${due√±oNom}`;
            } else if(tipo === "escarbato") {
                resultado = `√óü¶î ¬°${mascotaNom} ha encontrado 2.000 G ü™ô para ${due√±oNom} [${casaEmoji}]! √ó`;
                logTexto = `El Escarbato encontr√≥ galeones para ${due√±oNom}`;
            } else if(tipo === "murcielago") {
                resultado = `√óü¶á ¬°${mascotaNom} ha robado 2.000 G ü™ô para ${due√±oNom} [${casaEmoji}]! √ó`;
                logTexto = `El Murci√©lago rob√≥ galeones para ${due√±oNom}`;
            }

            enviarHistorial(due√±oNom, logTexto, resultado);
            document.getElementById('nombre-mascota-accion').value = "";
            document.getElementById('nombre-due√±o-accion').value = "";
        }

        function enviarHistorial(nombre, logTexto, copiaTexto) {
            const htmlEntrada = `<div class="entrada-criatura">
                <button class="btn-copiar" onclick="copiar(this)">Copiar üìã</button>
                <div style="font-size:11px; color:#aaa; margin-bottom:5px;">${new Date().toLocaleString()}</div>
                <div style="color:#8eeb9b; font-weight:bold;">üßô‚Äç‚ôÇÔ∏è ${nombre}:</div>
                <div style="color:#fff;">${logTexto}</div>
                <textarea style="display:none">${copiaTexto}</textarea>
            </div>`;
            fetch(DB_URL, { method: 'POST', body: JSON.stringify(htmlEntrada) }).then(() => {
                cargarHistorial();
                document.getElementById('historial-seccion').scrollIntoView({ behavior: 'smooth' });
            });
        }

        function copiar(btn) {
            const txt = btn.parentElement.querySelector('textarea').value;
            navigator.clipboard.writeText(txt).then(() => {
                btn.innerText = "¬°Copiado! ‚úÖ";
                setTimeout(() => btn.innerText = "Copiar üìã", 2000);
            });
        }

        function cargarHistorial() {
            fetch(DB_URL).then(res => res.json()).then(data => {
                const log = document.getElementById('log-content');
                if(!data) return;
                let html = "";
                Object.values(data).reverse().forEach(e => html += e);
                log.innerHTML = html;
            });
        }

        window.onload = cargarHistorial;
        setInterval(cargarHistorial, 5000);
    </script>
</body>
</html>
